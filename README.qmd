---
title: "tphconv: Convert Transport Poverty Hub Data to Rasters and Vectors"
format: gfm
default-image-extension: ""
---

# Overview

**tphconv** is an R package for converting public transport accessibility data from the Transport Poverty Hub into spatial formats. It’s designed to:

-   [x] Read gzipped CSV files containing point-based accessibility measures (e.g., number of people reachable within 10–20 minutes by public transport).
-   [x] Reproject WGS84 (EPSG:4326) coordinates into a target grid
  (default EPSG:3035) and perform necessary offset for the data to line up with GISCO INSPIRE grids (https://ec.europa.eu/eurostat/web/gisco/geodata/grids, https://ec.europa.eu/eurostat/web/gisco/geodata/population-distribution/population-grids).
-   [x] Rasterize the point data onto a regular grid (e.g., 1 km resolution) or generate vector polygon grids.
-   [ ] Convert to vector polygons for further analysis.

This makes it easy to integrate transport accessibility information into GIS workflows for analysis and visualization.

# Installation

You can install the development version of **tphconv** from GitHub:

``` r
# install.packages("remotes")
remotes::install_github("ekotov/tphconv")
```

# Data Source

Accessibility data is provided by the [Transport Poverty Hub Dashboard](https://jeodpp.jrc.ec.europa.eu/eu/vaas/voila/render/mobitrans/transportpoverty/TransportPovertyHub.ipynb), which requires a free EU account to log in. The dashboard allows you to download precomputed CSV files on a 1 km grid for various countries, including Luxembourg.

Once you have downloaded a file (e.g., `ver1_0_LU_1km_pt_ppl_within_10-20_min.csv.gz`), you can point **tphconv** to it directly.

# Usage Examples

Most defaults should work as long as the data provider does not change the format of the CSV files. The package is designed to handle the standard format used by the Transport Poverty Hub, but arguments can be adjusted if necessary.

## Convert a CSV to a Raster


``` r
library(tphconv)

# Locate the example data shipped with the package
tph_file <- system.file(
  "extdata",
  "ver1_0_LU_1km_pt_ppl_within_10-20_min.csv.gz",
  package = "tphconv"
)

# Convert to a SpatRaster
raster_layer <- tph_to_raster(input_file = tph_file)

library(terra)
plot(raster_layer)
```

![](man/figures/luxembourg.png)

## Write Raster to Disk

``` r
tmp_file <- tempfile(fileext = ".tiff")
output_path <- tph_to_raster(
  input_file = tph_file,
  out_raster_file = tmp_file
)

# Check the output
g <- terra::rast(output_path)
g
unlink(tmp_file)  # Clean up temporary file
```

```
class       : SpatRaster 
size        : 80, 55, 1  (nrow, ncol, nlyr)
resolution  : 1000, 1000  (x, y)
extent      : 4016000, 4071000, 2935000, 3015000  (xmin, xmax, ymin, ymax)
coord. ref. : ETRS89-extended / LAEA Europe (EPSG:3035) 
source      : file10888755abebd.tiff 
name        : opportunities_people 
min value   :                    0 
max value   :                61065 
```


# Functions

-   `tph_to_raster()` – Reads a CSV, reprojects, and rasterizes accessibility data into a SpatRaster or writes it to disk.

# License

The package is licensed under MIT. Data from the Transport Poverty Hub Dashboard is available under CC-BY-4.0, with reuse policy outlined by the [EU Commission Decision of 12 December 2011](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32011D0833).

# Citation

```{r}
#| eval: true
#| echo: false
#| results: 'asis'
print(citation("tphconv"), bibtex = FALSE)
```

BibTeX:

```
```{r}
#| eval: true
#| echo: false
#| results: 'asis'
toBibtex(citation("tphconv"))
```
```
