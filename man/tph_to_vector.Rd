% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tph_to_vector.R
\name{tph_to_vector}
\alias{tph_to_vector}
\title{Convert Transport Opportunities CSV to a Spatial Vector Object (Direct Method)}
\usage{
tph_to_vector(
  input_file,
  out_column_name = NULL,
  crs_src = 4326,
  crs_dst = 3035,
  x_offset = -500,
  y_offset = -500,
  resolution_m = 1000,
  out_vector_file = NULL,
  return_as = c("sf", "SpatVector"),
  add_id = TRUE
)
}
\arguments{
\item{input_file}{Character. Path to the input CSV (gzipped) containing at least
columns 'lon', 'lat', and one numeric data column.}

\item{out_column_name}{Character or NULL. Name to assign to the data column in the output raster.
If NULL (default), the original column name from the CSV is used.}

\item{crs_src}{Integer or character. Source CRS (EPSG code or WKT); default is 4326.}

\item{crs_dst}{Integer or character. Destination CRS (EPSG code or WKT); default is 3035.}

\item{x_offset}{Numeric. An offset subtracted from the projected x-coordinate.
This is used to convert the source point's reference (e.g., a lower-left
corner) to the cell's theoretical centroid. For centroid-based data like
GISCO, the default of 0 is correct.}

\item{y_offset}{Numeric. An offset subtracted from the projected y-coordinate,
similar to \code{x_offset}.}

\item{resolution_m}{Numeric. Cell size in units of the destination CRS; default is 1000 (1 km).}

\item{out_vector_file}{Character or \code{NULL}. If a file path is provided (e.g.,
\code{"data/luxembourg.gpkg"}), the output is written to that file using
\code{sf::st_write}, and the file path is returned. If \code{NULL} (the default),
the function returns an in-memory spatial object.}

\item{return_as}{Character. Specifies the class of the returned object when
\code{out_vector_file} is \code{NULL}. Can be either \code{"sf"} (the default) or
\code{"SpatVector"}. This argument is ignored if \code{out_vector_file} is not \code{NULL}.}

\item{add_id}{Logical. If \code{TRUE} (the default), an INSPIRE-compliant grid
cell ID is generated and added as a column named \code{"id"}. Set to \code{FALSE}
to omit this step.}
}
\value{
Depending on the arguments:
\itemize{
\item If \code{out_vector_file} is \code{NULL}, returns an \code{sf} object (default) or a \code{SpatVector}
object (if \code{return_as = "SpatVector"}) with polygon geometries.
\item If \code{out_vector_file} is a character string, the path to the created file is returned.
}
}
\description{
Reads a CSV file of public transport accessibility data and converts it
into a spatial vector format (\code{sf} or \code{terra::SpatVector}). This function
builds polygon geometries directly from the point coordinates in a vectorized
manner using the \code{sfheaders} package, which can be faster for sparse datasets
than methods requiring an intermediate raster.
}
\examples{
# This function requires the 'sfheaders' package
if (requireNamespace("sfheaders", quietly = TRUE)) {
  tph_file <- system.file(
    "extdata",
    "ver1_0_LU_1km_pt_ppl_within_10-20_min.csv.gz",
    package = "tphconv"
  )

  # Convert a CSV file to an sf object using the direct method
  sf_obj_direct <- tph_to_vector(input_file = tph_file)
  plot(sf_obj_direct)
}
}
